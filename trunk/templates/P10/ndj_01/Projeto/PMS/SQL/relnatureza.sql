select *, (case NIVEL when '1' then 'CREDITO' when '9' then 'CREDITO' else 'DEBITO' end) descnivel, ISNULL((SELECT ED_DESCRIC FROM SED010 WHERE ED_CODIGO = GRUPO),'SALDO INICIAL') AS DESCGRUPO  from (select ED_CODIGO,ED_DESCRIC,SUBSTRING(ED_CODIGO,1,1) AS NIVEL,SUBSTRING(ED_CODIGO,1,3) AS GRUPO,(SELECT ISNULL(SUM(E5_VALOR),0) FROM SE5010 WHERE SUBSTRING(E5_DATA,5,2)='01' AND E5_SITUACA <> 'C' AND SUBSTRING(E5_DATA,1,4)='2011' AND E5_NATUREZ = ED_CODIGO AND E5_CONTA = '70000-2' AND D_E_L_E_T_ <> '*') JAN,(SELECT ISNULL(SUM(E5_VALOR),0) FROM SE5010 WHERE SUBSTRING(E5_DATA,5,2)='02' AND E5_SITUACA <> 'C' AND SUBSTRING(E5_DATA,1,4)='2011' AND E5_NATUREZ = ED_CODIGO AND E5_CONTA = '70000-2' AND D_E_L_E_T_ <> '*') FEV,(SELECT ISNULL(SUM(E5_VALOR),0) FROM SE5010 WHERE SUBSTRING(E5_DATA,5,2)='03' AND E5_SITUACA <> 'C' AND SUBSTRING(E5_DATA,1,4)='2011' AND E5_NATUREZ = ED_CODIGO AND E5_CONTA = '70000-2' AND D_E_L_E_T_ <> '*') MAR,(SELECT ISNULL(SUM(E5_VALOR),0) FROM SE5010 WHERE SUBSTRING(E5_DATA,5,2)='04' AND E5_SITUACA <> 'C' AND SUBSTRING(E5_DATA,1,4)='2011' AND E5_NATUREZ = ED_CODIGO AND E5_CONTA = '70000-2' AND D_E_L_E_T_ <> '*') ABR,(SELECT ISNULL(SUM(E5_VALOR),0) FROM SE5010 WHERE SUBSTRING(E5_DATA,5,2)='05' AND E5_SITUACA <> 'C' AND SUBSTRING(E5_DATA,1,4)='2011' AND E5_NATUREZ = ED_CODIGO AND E5_CONTA = '70000-2' AND D_E_L_E_T_ <> '*') MAI,(SELECT ISNULL(SUM(E5_VALOR),0) FROM SE5010 WHERE SUBSTRING(E5_DATA,5,2)='06' AND E5_SITUACA <> 'C' AND SUBSTRING(E5_DATA,1,4)='2011' AND E5_NATUREZ = ED_CODIGO AND E5_CONTA = '70000-2' AND D_E_L_E_T_ <> '*') JUN,(SELECT ISNULL(SUM(E5_VALOR),0) FROM SE5010 WHERE SUBSTRING(E5_DATA,5,2)='07' AND E5_SITUACA <> 'C' AND SUBSTRING(E5_DATA,1,4)='2011' AND E5_NATUREZ = ED_CODIGO AND E5_CONTA = '70000-2' AND D_E_L_E_T_ <> '*') JUL,(SELECT ISNULL(SUM(E5_VALOR),0) FROM SE5010 WHERE SUBSTRING(E5_DATA,5,2)='08' AND E5_SITUACA <> 'C' AND SUBSTRING(E5_DATA,1,4)='2011' AND E5_NATUREZ = ED_CODIGO AND E5_CONTA = '70000-2' AND D_E_L_E_T_ <> '*') AGO,(SELECT ISNULL(SUM(E5_VALOR),0) FROM SE5010 WHERE SUBSTRING(E5_DATA,5,2)='09' AND E5_SITUACA <> 'C' AND SUBSTRING(E5_DATA,1,4)='2011' AND E5_NATUREZ = ED_CODIGO AND E5_CONTA = '70000-2' AND D_E_L_E_T_ <> '*') [SET],(SELECT ISNULL(SUM(E5_VALOR),0) FROM SE5010 WHERE SUBSTRING(E5_DATA,5,2)='10' AND E5_SITUACA <> 'C' AND SUBSTRING(E5_DATA,1,4)='2011' AND E5_NATUREZ = ED_CODIGO AND E5_CONTA = '70000-2' AND D_E_L_E_T_ <> '*') [OUT],(SELECT ISNULL(SUM(E5_VALOR),0) FROM SE5010 WHERE SUBSTRING(E5_DATA,5,2)='11' AND E5_SITUACA <> 'C' AND SUBSTRING(E5_DATA,1,4)='2011' AND E5_NATUREZ = ED_CODIGO AND E5_CONTA = '70000-2' AND D_E_L_E_T_ <> '*') NOV,(SELECT ISNULL(SUM(E5_VALOR),0) FROM SE5010 WHERE SUBSTRING(E5_DATA,5,2)='12' AND E5_SITUACA <> 'C' AND SUBSTRING(E5_DATA,1,4)='2011' AND E5_NATUREZ = ED_CODIGO AND E5_CONTA = '70000-2' AND D_E_L_E_T_ <> '*') DEZ from SED010 WHERE ED_TIPO = '2' AND SED010.D_E_L_E_T_ <> '*' AND ED_CODIGO < '999999999' and ED_CODIGO <> '90101' and ED_CODIGO <> '90102') as tab1 ORDER BY GRUPO, ED_CODIGO